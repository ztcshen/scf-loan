package {{ package }};

import {{ service_package }}.{{ service_name }};
import {{ entity_package }}.{{ entity_name }};
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.ArrayList;
import java.util.List;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.Mockito.*;

/**
 * {{ service_name }}单元测试
 */
public class {{ test_name }} {

    private static final Logger logger = LoggerFactory.getLogger({{ test_name }}.class);

    @Mock
    private {{ service_name }} {{ service_name|lower|replace('service', '') }}Service;

    @BeforeEach
    public void setUp() {
        MockitoAnnotations.openMocks(this);
    }

    /**
     * 测试批量创建{{ entity_name|replace('Entity', '') }}
     */
    @Test
    public void testBatchCreate{{ entity_name|replace('Entity', '') }}() {
        logger.info("开始执行测试批量创建{{ entity_name|replace('Entity', '') }}");
        
        List<{{ entity_name }}> entities = new ArrayList<>();
        
        // 创建测试数据
        {{ entity_name }} entity1 = new {{ entity_name }}();
        // 设置测试数据
        // entity1.setXXX(XXX);
        entities.add(entity1);
        
        {{ entity_name }} entity2 = new {{ entity_name }}();
        // 设置测试数据
        // entity2.setXXX(XXX);
        entities.add(entity2);
        
        // 模拟返回值
        when({{ service_name|lower|replace('service', '') }}Service.batchCreate{{ entity_name|replace('Entity', '') }}(entities)).thenReturn(true);
        
        boolean result = {{ service_name|lower|replace('service', '') }}Service.batchCreate{{ entity_name|replace('Entity', '') }}(entities);
        assertTrue(result);
        
        // 验证方法调用
        verify({{ service_name|lower|replace('service', '') }}Service, times(1)).batchCreate{{ entity_name|replace('Entity', '') }}(entities);
        
        logger.info("测试批量创建{{ entity_name|replace('Entity', '') }}执行完成");
    }

    /**
     * 测试批量更新{{ entity_name|replace('Entity', '') }}
     */
    @Test
    public void testBatchUpdate{{ entity_name|replace('Entity', '') }}() {
        logger.info("开始执行测试批量更新{{ entity_name|replace('Entity', '') }}");
        
        // 创建测试数据
        List<{{ entity_name }}> entities = new ArrayList<>();
        
        {{ entity_name }} entity1 = new {{ entity_name }}();
        // 设置测试数据
        // entity1.setXXX(XXX);
        entities.add(entity1);
        
        // 模拟返回值
        when({{ service_name|lower|replace('service', '') }}Service.batchUpdate{{ entity_name|replace('Entity', '') }}(entities)).thenReturn(true);
        
        boolean result = {{ service_name|lower|replace('service', '') }}Service.batchUpdate{{ entity_name|replace('Entity', '') }}(entities);
        assertTrue(result);
        
        // 验证方法调用
        verify({{ service_name|lower|replace('service', '') }}Service, times(1)).batchUpdate{{ entity_name|replace('Entity', '') }}(entities);
        
        logger.info("测试批量更新{{ entity_name|replace('Entity', '') }}执行完成");
    }

    /**
     * 测试分页查询{{ entity_name|replace('Entity', '') }}
     */
    @Test
    public void testPage{{ entity_name|replace('Entity', '') }}() {
        logger.info("开始执行测试分页查询{{ entity_name|replace('Entity', '') }}");
        
        // 创建模拟返回数据
        List<{{ entity_name }}> mockEntities = new ArrayList<>();
        for (int i = 0; i < 10; i++) {
            {{ entity_name }} entity = new {{ entity_name }}();
            // 设置测试数据
            // entity.setXXX(XXX);
            mockEntities.add(entity);
        }
        
        // 模拟返回值
        when({{ service_name|lower|replace('service', '') }}Service.page{{ entity_name|replace('Entity', '') }}(1, 10)).thenReturn(mockEntities);
        
        // 执行方法
        List<{{ entity_name }}> pageResult = {{ service_name|lower|replace('service', '') }}Service.page{{ entity_name|replace('Entity', '') }}(1, 10);
        
        // 验证结果
        assertNotNull(pageResult);
        assertEquals(10, pageResult.size());
        
        // 验证方法调用
        verify({{ service_name|lower|replace('service', '') }}Service, times(1)).page{{ entity_name|replace('Entity', '') }}(1, 10);
        
        logger.info("测试分页查询{{ entity_name|replace('Entity', '') }}执行完成");
    }
}

